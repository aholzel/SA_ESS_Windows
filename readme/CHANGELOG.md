# CHANGELOG
This file will contain the changes to the script files. In the script files you will only find th current major version change log. The file is split up in two parts, to make it easier to find the latest changes. The top part contains the latest changes per script and in general for the app. The bottom part contains all the changes.

| Date       | Version | Author  | **[Type]** Description                                                                |
|:-----------|:--------|:--------|:--------------------------------------------------------------------------------------|
| 2025-01-06 | 5.8.1   | Arnold  | **[ADD]** props/transforms/eventtypes for WinEventLog:Microsoft-Windows-Windows Firewall With Advanced Security/Firewall <br /> **[ADD]** Blacklist for WinEventlog:System

# Latest version:
## General app changes
| Date       | Version | Author  | **[Type]** Description                                                                |
|:-----------|:--------|:--------|:--------------------------------------------------------------------------------------|
| -          | 1.0     | Arnold  | initial version
| -          | 1.1     | Arnold  | bug fixes
| 2016-04-13 | 1.2     | Arnold  | changed the query's in the dashboards to use an macro for index and sourcetype. <br />added this changelog
| 2016-05-02 | 1.3     | Arnold  | added fieldalias for severity_id and vendor_severity because in the Splunk_TA_windows the <br />fieldaliases are incorrect<br />changed default directory to local to make sure the changes in this app overrule the default apps
| 2016-05-27 | 1.4     | Arnold  | changed the macro's to include an index macro and include the XmlWinEventLog<br />formats.<br />The eventtypes.conf now also uses the macro's.<br />Default props are also propagated to the XmlWinEventLog sourcetype.
| 2016-07-11 | 1.5     | Arnold  | Added an new lookup file windows_status_codes.csv with windows 32bit status codes created some<br />automatic lookups, and eval's, reversed the macro's in the eventtypes because they break in a<br />cluster enviroment
| 2016-07-28 | 1.6     | Arnold  | Added some default Splunk_TA_windows stanzas to override the regex that is used in these stanzas
| 2017-02-06 | 1.7     | Arnold  | Added sedcmd command to reduce the amount of indexed data. this removes the default text in<br />EventCodes 4616/4624/4625/4634/4647/4648/4688<br />Added field extract for xml style fieldnames for subject and target users.
| 2017-04-14 | 1.8     | Arnold  | Added field extracts for the Process_Command_Line field (only has content if GPO is enabled)<br />Changed the powershell dashboard.
| 2017-08-31 | 2.0     | Arnold  | Changed a lot in props.conf and transforms.conf, merged some lookups from the Splunk_TA_windows<br /> into one lookup, "Everything" for the Authentication DM is now ready in this app to replace the<br />Splunk_TA_windows, Change_Analysis DM is approximately halfway 
| 2017-10-04 | 2.1     | Arnold  | More changes to props and transforms.<br />Changed the name to SA-ESS so it will be loaded before the Splunk_TA_windows this will prevent the<br />Splunk_TA_windows from breaking things on a couple of fields.<br />Moved everything to default.<br />Updated the fieldalias's for the Dutch Windows Eventlog 
| 2017-10-30 | 2.2     | Arnold  | Removed all the XmlWinEventLog stuff<br />Added sedcmd for EventCode 4627
| 2017-11-13 | 2.3     | Arnold  | Changed some props EVAL fields to get the group changes correct in the Change_Analysis Datamodel
| 2017-11-20 | 2.4     | Arnold  | Changed some props EVAL fields<br />Changed windows_group_management eventtype to prevent that EventCode 4737 shows op in the<br />Change_Analysis Datamodel
| 2017-11-23 | 2.5     | Arnold  | Added the userAccountControl lookup table.
| 2017-11-24 | 2.6     | Arnold  | Added sub codes for EventCode 4697 (service installation) and more detail in the user and<br /> src_user fields.
| 2017-12-04 | 2.7     | Arnold  | Changes in the props.conf SEDCMD's
| 2018-03-15 | 2.8     | Arnold  | Changes in the props/transforms for CIM, updated lookups with extra info
| 2018-03-23 | 2.9     | Arnold  | Added extracts en eventtype for the Updates DM based on WineventLog:System
| 2018-04-19 | 3.0     | Arnold  | Fixed some regex errors.<br />Extended the windows_signature_extended lookup with more kerberos info.<br />Added the win:logon:kerb app name for kerberos related logons<br />Made a difference between security and distribution groups in the windows_signature_extended<br />lookup object_category
| 2018-04-25 | 3.1     | Arnold  | Fixed typo in eventtypes<br />Added extracts for Application State DM
| 2018-05-11 | 3.2     | Arnold  | Added eventtype for kerberos authentication<br />Added DM tags for kerberos authentication
| 2018-06-26 | 3.3     | Arnold  | Added more options to the windows_signature_extended lookup for EventCode 4625
| 2018-07-19 | 3.4.1   | Arnold  | Made some changes to merge the Group changes into the Change_Analysis DM under Account_Management<br />changes and additions to the powershell related transforms<br />Changed version numbering to match the new Splunk 7 requirement "major.minor.patch"
| 2018-08-15 | 3.5.1   | Arnold  | Mostly changes to handle the change of Splunk_TA_windows 5.0.0 to change the sourcetype of ALL<br /> windows eventlogs to wineventlog.
| 2018-09-03 | 3.5.2   | Arnold  | Replaced the summariesonly macro to summariesonly=t in the dashboards, to prevent errors in non<br />ES environments.
| 2018-09-03 | 3.5.3   | Arnold  | Dashboard basesearch fixes
| 2018-09-10 | 3.6.0   | Arnold  | Added correlation search.<br />Metadata changed to export macros system wide to make them work in ES 5.x<br />Windows update eventtype changed to make it work for dutch Windows.<br />Added status tag to de WindowsUpdate_error eventtype to make them searchable via tstats<br />Added props/transforms for System and Application logs to fill the Updates and Application State datamodels
| 2018-10-01 | 3.6.1   | Arnold  | Changed the macro's in the eventtypes for eventtypes because the distsearch.conf doesn't work for <br />some reason. In Splunk 7.1.x this will result in the rather strange error "[«INDEXERNAME»]" <br /> Application does not exist: SplunkEnterpriseSecuritySuite" if you do a `datamodel` or `tstats` search.
| 2018-12-02 | 3.7.1   | Arnold  | Reverted the sourcetype vs source changes made for the official Splunk_TA_windows 5.x app because<br /> that change can not hold... it even breaks Splunks own apps...<br />Moved the SEDCMD options to a general WinEventLog sourcetype stanza so it apply's to all <br />windows eventlogs<br />Fixed some typo's and edge case EVAL's
| 2018-12-05 | 3.7.2   | Arnold  | (temporarily) disabled the fieldalias "01_Windows_NL_to_EN" to dodge a Splunk 7.2.1 bug <br />that disables field extractions for fields that are aliased. 
| 2019-02-08 | 3.8.1   | Arnold  | Made some changes to the user and src_user evals so that group changes now have the changing <br />user as the src_user and the changed user as the user in the Change DM.
| 2019-04-24 | 3.9.0   | Arnold  | Removed all the EXTRACT-mssql_audit_fields_* field extracts because the fix of the wel-col-kv made <br />all the fields multi value with the same value twice. <br />Made some additional changes to the wel-col-kv to handle some edge cases where there was <br />no "hard" enter at the end of a line in the windows eventlogs<br />Added a SEDCMD to remove the content of the ms-mcs-AdmPwd field when admon is enabled and<br />Microsoft LAPS is used, to prevent the indexing of local admin passwords.
| 2019-05-15 | 3.9.1   | Arnold  | **[FIX]** typo in the SEDCMD to remove the password from the ms-Mcs-AdmPwd field.
| 2019-07-12 | 3.9.2   | Arnold  | **[FIX]** for the 2 windows_signature lookups, made sure the status_code field always has a value so<br />now only 1 lookup is needed.<br />**[DEL]** the 02_windows_signature_lookup (the one without status_code) because in some cases the <br />lookups didn't work as expected.<br />**[MOD]** added a "-" in the status_code field in the windows_signature_extended lookup if there was<br />no value before.
| 2019-11-01 | 4.0.0   | Arnold  | **[MOD]** enabled the fieldaliases again, if you run a Splunk version lower than 7.3 please disable<br />them again to prevent error messages<br />**[MOD]** changed props.conf stanzas from sourcetype to source<br />**[ADD]** field extracts, evals, eventtypes, tags to let the EventCode 4688 events land in the<br />endpoint.processes datamodel<br />
| 2020-01-16 | 4.0.1   | Arnold  | **[FIX]** Missing quote caused problemsn with the EVAL-app<br />**[FIX]** EVAL-user was incorrect
| 2020-01-30 | 4.0.2   | Arnold  | **[MOD]** changed KV_MODE back to auto
| 2020-08-20 | 4.0.3   | Arnold  | **[ADD]** fieldextract for New_Time and Previous_Time, for some reason there are unprintable/hidden<br />chars in that field.
| 2020-09-28 | 4.1.0   | Arnold  | **[ADD]** added fieldextract etc. to put the SQL authentication events from the application logs into<br />the Authentication datamodel<br />**[ADD]** added new lookup file for the application log events, that are used in the datamodels<br />**[ADD]** added new lookup windows_legacy_signature_extended.csv and moved all the <br />pre win2008 eventcodes there. This lookup is only there for reverance, just in case for if you find a forgotten<br /> server, no auto lookups will be done and no definition has been made.<br />**[DEL]** removed all the pre win2008 event ids from the windows_signature_extended lookup<br />**[MOD]** eventtypes replaced the sourcetype= for source= 
| 2021-02-03 | 4.2.0   | Arnold  | **[FIX]** made a fix for a bug in the dutch windows 10 eventlog security<br />**[MOD]** SQL_logon eventtype and lookup
| 2021-03-12 | 4.3.0   | Arnold  | **[MOD]** Small change to some eventtypes to make the search faster.
| 2021-04-09 | 4.4.0   | Arnold  | **[DEL]** Removed the default_accounts.xml dashboard because of a lot of deprecated options<br /> **[DEL]** Removed the windows_status_codes.csv lookup because it is a duplicate of the hex lookup<br /> **[MOD]** Changes to the lookups because of the use of double quotes.<br /> **[MOD]** More changes based on the app inspect check feedback<br />**[MOD]** Moved changelog to this file
| 2021-05-06 | 5.0.0   | Arnold  | **[NOTE]** Please remove the old version of the app before installing this one <br />**[NEW]** App is now Splunk Cloud compatible, the first Splunk Cloud installment is successfully done. <br />**[MOD]** Changed the directory name from SA-ESS-Windows to SA_ESS_Windows to be able to<br /> comply with the app.conf > package > id requirements.<br />**[MOD]** Changes to the eventtypes to make the searches faster. <br />**[MOD]** Changed the props for the ActiveDirectory data from sourcetype to source because of <br />Splunk Cloud restrictions on SEDCMD for sourcetype <br />**[MOD]** Enabled the "Suspicous PowerShell" saved search because of Splunk Cloud restrictions <br />on disabled saved searches. <br />**[MOD]** Updated the README.md file <br />**[ADD]** Lookup definitions that where missing. <br />**[DEL]** windows_status_codes.csv lookup and definition <br />**[DEL]** "default accounts" dashboards, this dashboard was to fix some problems with the default <br />Enterprise Security one. **[FIX]** Typo in the "admin password change" dashboard. <br />**[FIX]** Field naming errors in the "group management" dashboard, also made the base searches faster. <br />**[FIX]** windows_hex_lookup.csv had some problems with quotes <br />
| 2021-05-25 | 5.0.1   | Arnold  | **[FIX]** missing quote in eventtypes.conf <br />
| 2021-06-09 | 5.1.0   | Arnold  | **[ADD]** props/transforms/eventtypes/tags for the "WinEventlog:Directory Service" bind logins <br />
| 2021-06-25 | 5.2.0   | Arnold  | **[ADD]** New values to the userAccountControl lookup (also working on a macro to do this)**[ADD]** wel-eq-kv2 stanza in transforms.conf to fix the DELIMS problems <br />**[DEL]** wel-eq-kv stanza in transforms.conf due to problems with the empty DELIMS <br />**[MOD]** Disabled the Powershell savedsearch again. <br />**[MOD]** Changes to the AD info search <br />**[MOD]** Moved this file and the README to the /readme dir
| 2021-07-02 | 5.2.1   | Arnold  | **[FIX]** Resolved faulty windwos_signature_extended.csv lookup
| 2021-08-25 | 5.3.0   | Arnold  | **[ADD]** `uac_exp` macro to replace the userAccountControl lookup. <br /> **[ADD]** (more specific) signatures for EventCodes 4627/4768/4769/5140/5145 <br /> **[DEP]** The userAccountControl lookup is depricated, please use the macro instead. <br /> **[FIX]** Incorrect tag for cleartext logon. <br /> **[MOD]** Changes to the 'AD info' dashboard to search for specific data.
| 2021-11-11 | 5.4.0   | Arnold  | **[FIX]** Typo in props `New_Time` field <br /> **[FIX]** Changed the account lockout dashboard to use the Change DM **[MOD]** Changed the marcos.conf to make the data releated macros more precise. <br /> **[MOD]** Changed savedsearches and dashboards to use the new macros 
| 2021-12-29 | 5.5.0   | Arnold  | **[ADD]** New events and/or better info in Windows signature lookup table
| 2023-09-15 | 5.6.0   | Arnold  | **[ADD]** Additonal fields for Directory Service events. <br />**[ADD]** Eventtype for file access and firewall events<br /> **[DEL]** EventCode 4648 from the Winlogon eventtypes. This event is only logged on succes and also creates a 4624.<br />**[MOD]** Action info in Windows signature lookup table based on datamodel required field values. <br />
| 2023-12-28 | 5.6.1   | Arnold  | **[MOD]** Minor changes
| 2024-04-29 | 5.7.0   | Arnold  | **[ADD]** inputs.conf with blacklist for security logs and whitelist for application log <br /> **[ADD]** props/transforms for WinEventLog:Application 